import{R as _,a as b,r as E,H as h,w as O,l as S,n as C,p as T,q,S as x,T as D,U as I,V as U,W as F,X as J,x as N}from"./index-C5Q1Okh6.js";var c={},g;function k(){if(g)return c;g=1;var s=_();return c.createRoot=s.createRoot,c.hydrateRoot=s.hydrateRoot,c}var L=k();const P=b({__name:"ExcalidrawEditor",props:{name:{type:String,required:!0},yeles:{type:Object,required:!0},yfiles:{type:Object,required:!0}},setup(s){window.EXCALIDRAW_EXPORT_SOURCE=globalThis.origin,window.EXCALIDRAW_ASSET_PATH="/";const r=s,d=E(),u=E(),f=(e,a)=>{for(const[t,o]of e){const n=JSON.stringify(o);if(!a.has(t)){a.set(t,JSON.parse(n));continue}const l=a.get(t);JSON.stringify(l)!==n&&a.set(t,JSON.parse(n))}for(const t of a.keys())e.has(t)||a.delete(t)},A=(e,a,t)=>{const o=new Map((e.elements??[]).map(l=>[l.id,l])),n=new Map(Object.entries(e.files??[]));J(a.doc,()=>{f(o,a),f(n,t)},"excalidraw",!0)},R=(e,a,t)=>{const o=x(e,a,t);A(o,r.yeles,r.yfiles),d.value=o},p=e=>{e.transaction.origin==="excalidraw"||e.transaction.local||u.value?.updateScene({elements:Array.from(r.yeles.values()),captureUpdate:F.NEVER})},v=e=>{e.transaction.origin==="excalidraw"||e.transaction.local||u.value?.addFiles(Array.from(r.yfiles.values()))};let i;const m=h("excalidraw"),w=()=>{d.value=x(Array.from(r.yeles.values()),void 0,r.yfiles.toJSON()),r.yeles.observe(p),r.yfiles.observe(v),i=L.createRoot(m.value),i.render(D.createElement(I,{UIOptions:{canvasActions:{loadScene:!1,saveToActiveFile:!1}},langCode:"en",name:r.name,theme:"light",viewModeEnabled:!1,initialData:{...d.value,scrollToContent:!0},excalidrawAPI:e=>u.value=e,onLinkOpen:(e,a)=>{a.preventDefault()},onLibraryChange:()=>{},onChange:U((e,a,t)=>{R(e,a,t)},250)}))},y=()=>{i&&i.unmount(),r.yeles.unobserve(p),r.yfiles.unobserve(v)};return O(()=>r.yeles,()=>{y(),w()}),S(w),C(y),(e,a)=>(q(),T("div",{ref_key:"excalidraw",ref:m,class:"excalidraw-wrapper"},"Loading...",512))}}),j=N(P,[["__scopeId","data-v-8ee81dff"]]);export{j as default};
